/*
 sideburn.js
 http://scrappit.org/sideburn
 MIT License
 Author: Josh Dzielak, Copyright (c) 2011

 Convert HTML to mustache-friendly JSON.

 Given this DOM:
    <div><img src="foo.png"/>sideburn</div>

  sideburn.js produces a superset of this JSON object structure:

  {
    div : {
      img : { src : 'foo.png' },
      text : 'sideburn'
    }
  }

 To maximize the Child nodes are reachable from their parent by
 attribute names, element names, classes, or ID.

 */(function(a,b){function x(a){return f.call(a)==="[object Array]"}function y(a){return a.localName?a.localName:a.baseName}function z(a){return a.replace(w,"")}function A(a){return String(a).replace(v,"_")}function B(a,b){return a[A(b)]}function C(a,b,c){a[A(b)]=c}function D(a){return j+a}function E(a){return i+a}function F(a){return h+a}function G(a){var b={toString:function(){return this[o]}};b[F(m)]=a,b[F(n)]=y(a),b[F(l)]=[],b[F(k)]={},b[E(o)]=[];var c=[p,q,r,s];for(var d=0,e=c.length;d<e;d++){var f=c[d];b[D(f)]={}}return b}function H(a,b){var c=a.attributes;for(var d=0,e=c.length;d<e;d++){var f=c[d],g=f.name,h=f.value;C(b[E(k)],g,h),C(b,g,h)}}function I(a,b,c){var d=a.attributes;for(var e=0,f=d.length;e<f;e++){var g=d[e];g.name!==o&&N(c[D(p)],g.name,b)}}function J(a,b,c){var d=a.attributes.getNamedItem(r);if(d){var e=d.value.split(" ");for(var f=0,g=e.length;f<g;f++){var h=e[f];h!==o&&N(c[D(r)],h,b)}}}function K(a,b,c){var d=a.attributes.getNamedItem(s);if(d){var e=d.value;e!==o&&N(c[D(s)],e,b)}}function L(a,b,c){var d=y(a);d!==o&&N(c[D(q)],d,b)}function M(a,b){var c=!1;for(var d=0,e=b.length;d<e;d++){var f=b[d];if(f==a){c=!0;break}}c||b.push(a)}function N(a,b,c,d){var e;(e=B(a,b))||C(a,b,e=[]),x(c)||(c=[c]);for(var f=0,g=c.length;f<g;f++){var h=c[f];d?e.push(h):M(h,e)}}function O(a,b){return E(a+E(b))}function P(a,b,c){for(var d=0,e=c.length;d<e;d++)C(a,O(b,d),c[d])}function Q(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];for(key in e){var f=e[key];key!==o&&C(a,key,f[0]),N(a,E(key),f),P(a,key,f),N(a,F(l),f)}}}function R(a){a[t]=z(a)}function S(a){var b=a[E(o)],c=[],d="";for(var e=0,f=b.length;e<f;e++){var g=b[e];c.push(z(g)),d+=g}a[o]=d,a[u]=z(d),P(a,o,b),P(a,u,c)}function T(a){var b=a[F(m)];if(b&&b.hasChildNodes()){var c=b.childNodes.length-1,d=0;do{var e=b.childNodes[d];switch(e.nodeType){case 1:var f=G(e);I(e,f,a),L(e,f,a),J(e,f,a),K(e,f,a),e.hasChildNodes()&&T(f,e);break;case 3:N(a,E(o),e.nodeValue,!0);break;case 4:N(a,E(o),e.text?e.text:e.nodeValue,!0)}}while(d++<c)}return Q(a,[a[D(p)],a[D(q)],a[D(r)],a[D(s)]]),H(b,a),S(a),a}function U(a){return T(G(a))}function V(a){var c=b.all?new ActiveXObject("Microsoft.XMLDOM"):new DOMParser;return c.async=!1,b.all?c.loadXML(a)?c:!1:c.parseFromString(a,"text/xml")}var c="0.1.0+",d=undefined,e=""+d,f=Object.prototype.toString,g="_",h=g,i=g,j=h+"by"+h,k="attributes",l="children",m="node",n="node_name",o="text",p="attribute",q="element",r="class",s="id",t=h+"trimmed",u=o+t,v=/-/g,w=/^\s+|\s+$/gm,W=function(){var a=function(a){return typeof a=="string"&&(a=V(a).documentElement),U(a)};return a.textToDocument=V,a},X=!0;typeof define=="function"&&define.amd&&(define([],W),X=!1),typeof module!==e&&module.exports&&(module.exports=W(),X=!1),X&&(a.sideburn=W())})(this,document)